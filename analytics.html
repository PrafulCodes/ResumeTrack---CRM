<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ResumeTrack | Analytics</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.0.0/dist/chart.umd.min.js"></script>
</head>
<body class="bg-gradient-to-br from-gray-50 to-indigo-50 min-h-screen flex font-sans">

  <!-- Sidebar -->
  <aside class="w-64 bg-gradient-to-b from-indigo-600 to-purple-700 text-white flex flex-col shadow-2xl">
    <div class="px-6 py-6 border-b border-indigo-400 border-opacity-30">
      <div class="flex items-center space-x-3">
        <div class="bg-white bg-opacity-20 p-2 rounded-xl backdrop-blur-sm">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
          </svg>
        </div>
        <span class="text-2xl font-bold">ResumeTrack</span>
      </div>
    </div>

    <nav class="flex-1 p-4 space-y-2">
      <a href="dashboard.html" class="block px-4 py-3 hover:bg-white hover:bg-opacity-10 rounded-xl transition-all duration-200 font-medium">
        📊 Dashboard
      </a>
      <a href="candidates.html" class="block px-4 py-3 hover:bg-white hover:bg-opacity-10 rounded-xl transition-all duration-200 font-medium">
        👥 Candidates
      </a>
      <a href="add-candidate.html" class="block px-4 py-3 hover:bg-white hover:bg-opacity-10 rounded-xl transition-all duration-200 font-medium">
        ➕ Add Candidate
      </a>
      <a href="analytics.html" class="block bg-white bg-opacity-20 backdrop-blur-sm text-white rounded-xl px-4 py-3 font-semibold shadow-lg transform transition-all duration-200 hover:scale-105">
        📈 Analytics
      </a>
    </nav>

    <button id="logoutBtn" class="m-4 px-4 py-3 bg-red-500 hover:bg-red-600 text-white rounded-xl font-semibold shadow-lg transition-all duration-200 transform hover:-translate-y-0.5 hover:shadow-xl">
      🚪 Logout
    </button>
  </aside>

  <!-- Main Content -->
  <main class="flex-1 p-8 overflow-y-auto">
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8">
      <div>
        <h1 class="text-3xl font-bold text-gray-800">Recruitment Analytics</h1>
        <p class="text-gray-500 mt-1">Deep insights into your hiring performance</p>
      </div>
      <button id="exportBtn" class="bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 text-white px-6 py-3 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all duration-200 transform hover:-translate-y-0.5 flex items-center space-x-2">
        <span>📥</span>
        <span>Export Report</span>
      </button>
    </div>

    <!-- Export Success Message -->
    <div id="exportSuccess" class="hidden bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 text-green-700 px-6 py-4 rounded-xl mb-6 shadow-lg transform transition-all duration-300">
      <div class="flex items-center space-x-3">
        <span class="text-2xl">✅</span>
        <div>
          <p class="font-bold">Report Exported Successfully!</p>
          <p class="text-sm">Your analytics report has been downloaded.</p>
        </div>
      </div>
    </div>

    <!-- KPI Cards -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
      <div class="p-6 rounded-2xl shadow-xl text-white bg-gradient-to-br from-indigo-500 to-indigo-700 transform hover:scale-105 transition-all duration-200 hover:shadow-2xl">
        <div class="flex items-center justify-between mb-4">
          <div class="bg-white bg-opacity-20 p-3 rounded-xl backdrop-blur-sm">
            <span class="text-3xl">⏱️</span>
          </div>
          <div class="bg-white bg-opacity-20 px-3 py-1 rounded-lg text-sm font-semibold">
            Improved
          </div>
        </div>
        <h2 class="text-lg font-semibold opacity-90">Avg Time-to-Hire</h2>
        <p class="text-4xl font-bold mt-2">28 Days</p>
        <p class="text-sm mt-3 opacity-80 flex items-center space-x-1">
          <span class="bg-white bg-opacity-20 px-2 py-0.5 rounded">↓ 3 days</span>
          <span>from last month</span>
        </p>
      </div>

      <div class="p-6 rounded-2xl shadow-xl text-white bg-gradient-to-br from-green-500 to-emerald-700 transform hover:scale-105 transition-all duration-200 hover:shadow-2xl">
        <div class="flex items-center justify-between mb-4">
          <div class="bg-white bg-opacity-20 p-3 rounded-xl backdrop-blur-sm">
            <span class="text-3xl">📊</span>
          </div>
          <div class="bg-white bg-opacity-20 px-3 py-1 rounded-lg text-sm font-semibold">
            Trending Up
          </div>
        </div>
        <h2 class="text-lg font-semibold opacity-90">Conversion Rate</h2>
        <p class="text-4xl font-bold mt-2">21%</p>
        <p class="text-sm mt-3 opacity-80 flex items-center space-x-1">
          <span class="bg-white bg-opacity-20 px-2 py-0.5 rounded">↑ 5%</span>
          <span>from last month</span>
        </p>
      </div>

      <div class="p-6 rounded-2xl shadow-xl text-white bg-gradient-to-br from-purple-500 to-pink-600 transform hover:scale-105 transition-all duration-200 hover:shadow-2xl">
        <div class="flex items-center justify-between mb-4">
          <div class="bg-white bg-opacity-20 p-3 rounded-xl backdrop-blur-sm">
            <span class="text-3xl">👥</span>
          </div>
          <div class="bg-white bg-opacity-20 px-3 py-1 rounded-lg text-sm font-semibold">
            Active
          </div>
        </div>
        <h2 class="text-lg font-semibold opacity-90">Active Candidates</h2>
        <p class="text-4xl font-bold mt-2">173</p>
        <p class="text-sm mt-3 opacity-80">
          <span>In hiring pipeline</span>
        </p>
      </div>
    </div>

    <!-- Charts Section -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
      <div class="bg-white p-8 rounded-2xl shadow-lg transform hover:shadow-xl transition-all duration-200">
        <div class="flex items-center justify-between mb-6">
          <div>
            <h2 class="text-xl font-bold text-gray-800">Pipeline Distribution</h2>
            <p class="text-sm text-gray-500 mt-1">Current candidate stages</p>
          </div>
          <div class="bg-gradient-to-r from-indigo-50 to-purple-50 px-3 py-1 rounded-lg">
            <span class="text-sm font-semibold text-indigo-600">Live Data</span>
          </div>
        </div>
        <div class="flex justify-center">
          <canvas id="donutChart" style="max-height: 300px;"></canvas>
        </div>
      </div>

      <div class="bg-white p-8 rounded-2xl shadow-lg transform hover:shadow-xl transition-all duration-200">
        <div class="flex items-center justify-between mb-6">
          <div>
            <h2 class="text-xl font-bold text-gray-800">Top Skills in Demand</h2>
            <p class="text-sm text-gray-500 mt-1">Most requested competencies</p>
          </div>
          <div class="bg-gradient-to-r from-indigo-50 to-purple-50 px-3 py-1 rounded-lg">
            <span class="text-sm font-semibold text-indigo-600">Top 8</span>
          </div>
        </div>
        <canvas id="barChart" style="max-height: 300px;"></canvas>
      </div>
    </div>

    <!-- Full Width Line Chart -->
    <div class="bg-white p-8 rounded-2xl shadow-lg transform hover:shadow-xl transition-all duration-200">
      <div class="flex items-center justify-between mb-6">
        <div>
          <h2 class="text-xl font-bold text-gray-800">Hiring Trend Analysis</h2>
          <p class="text-sm text-gray-500 mt-1">Last 6 months performance overview</p>
        </div>
        <div class="bg-gradient-to-r from-indigo-50 to-purple-50 px-3 py-1 rounded-lg">
          <span class="text-sm font-semibold text-indigo-600">📈 6 Months</span>
        </div>
      </div>
      <canvas id="lineChart" style="max-height: 400px;"></canvas>
    </div>

    <!-- Insights Card -->
    <div class="mt-8 bg-gradient-to-r from-indigo-500 to-purple-600 p-8 rounded-2xl shadow-xl text-white">
      <div class="flex items-center space-x-3 mb-6">
        <div class="bg-white bg-opacity-20 p-3 rounded-xl backdrop-blur-sm">
          <span class="text-3xl">💡</span>
        </div>
        <h2 class="text-2xl font-bold">Key Insights</h2>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="bg-white bg-opacity-20 backdrop-blur-sm p-4 rounded-xl">
          <div class="text-2xl mb-2">🎯</div>
          <h3 class="font-bold mb-2">High Conversion</h3>
          <p class="text-sm opacity-90">Your offer-to-hire ratio improved by 5% this month</p>
        </div>
        <div class="bg-white bg-opacity-20 backdrop-blur-sm p-4 rounded-xl">
          <div class="text-2xl mb-2">⚡</div>
          <h3 class="font-bold mb-2">Faster Hiring</h3>
          <p class="text-sm opacity-90">Time-to-hire decreased by 3 days on average</p>
        </div>
        <div class="bg-white bg-opacity-20 backdrop-blur-sm p-4 rounded-xl">
          <div class="text-2xl mb-2">🔥</div>
          <h3 class="font-bold mb-2">Tech in Demand</h3>
          <p class="text-sm opacity-90">JavaScript and Python lead skill requirements</p>
        </div>
      </div>
    </div>
  </main>

  <script>
    // Auth check (using sessionStorage for consistency)
    if (sessionStorage.getItem('isLoggedIn') !== 'true') {
      window.location.href = 'index.html';
    }

    // Logout
    document.getElementById('logoutBtn').addEventListener('click', () => {
      sessionStorage.clear();
      window.location.href = 'index.html';
    });

    // Chart.js Data
    const donutData = {
      labels: ['Applied', 'Screening', 'Interview', 'Offer', 'Hired', 'Rejected'],
      datasets: [{
        data: [65, 48, 42, 18, 52, 23],
        backgroundColor: [
          '#9CA3AF',
          '#FBBF24',
          '#6366F1',
          '#A855F7',
          '#22C55E',
          '#EF4444'
        ],
        borderWidth: 0,
        hoverOffset: 15
      }]
    };

    const barData = {
      labels: ['JavaScript', 'Python', 'React', 'Java', 'Node.js', 'AWS', 'SQL', 'Docker'],
      datasets: [{
        label: 'Demand Count',
        data: [85, 72, 68, 65, 58, 52, 48, 45],
        backgroundColor: [
          '#6366F1',
          '#22C55E',
          '#A855F7',
          '#F59E0B',
          '#EC4899',
          '#8B5CF6',
          '#14B8A6',
          '#F87171'
        ],
        borderRadius: 8,
        borderWidth: 0
      }]
    };

    const lineData = {
      labels: ['May', 'June', 'July', 'Aug', 'Sep', 'Oct'],
      datasets: [
        {
          label: 'Candidates Hired',
          data: [8, 12, 15, 10, 14, 12],
          borderColor: '#22C55E',
          backgroundColor: 'rgba(34,197,94,0.2)',
          fill: true,
          tension: 0.4,
          borderWidth: 3,
          pointBackgroundColor: '#22C55E',
          pointBorderColor: '#fff',
          pointBorderWidth: 2,
          pointRadius: 5,
          pointHoverRadius: 7
        },
        {
          label: 'Applications Received',
          data: [45, 52, 48, 55, 62, 58],
          borderColor: '#6366F1',
          backgroundColor: 'rgba(99,102,241,0.2)',
          fill: true,
          tension: 0.4,
          borderWidth: 3,
          pointBackgroundColor: '#6366F1',
          pointBorderColor: '#fff',
          pointBorderWidth: 2,
          pointRadius: 5,
          pointHoverRadius: 7
        },
        {
          label: 'Interviews Conducted',
          data: [22, 28, 25, 30, 35, 32],
          borderColor: '#A855F7',
          backgroundColor: 'rgba(168,85,247,0.2)',
          fill: true,
          tension: 0.4,
          borderWidth: 3,
          pointBackgroundColor: '#A855F7',
          pointBorderColor: '#fff',
          pointBorderWidth: 2,
          pointRadius: 5,
          pointHoverRadius: 7
        }
      ]
    };

    // Render Charts with enhanced options
    new Chart(document.getElementById('donutChart'), {
      type: 'doughnut',
      data: donutData,
      options: {
        responsive: true,
        maintainAspectRatio: true,
        plugins: {
          legend: {
            position: 'bottom',
            labels: {
              padding: 15,
              font: { size: 12 },
              usePointStyle: true
            }
          }
        }
      }
    });

    new Chart(document.getElementById('barChart'), {
      type: 'bar',
      data: barData,
      options: {
        responsive: true,
        maintainAspectRatio: true,
        plugins: {
          legend: { display: false }
        },
        scales: {
          y: {
            beginAtZero: true,
            grid: {
              color: 'rgba(0, 0, 0, 0.05)'
            }
          },
          x: {
            grid: { display: false }
          }
        }
      }
    });

    new Chart(document.getElementById('lineChart'), {
      type: 'line',
      data: lineData,
      options: {
        responsive: true,
        maintainAspectRatio: true,
        plugins: {
          legend: {
            position: 'top',
            labels: {
              padding: 15,
              font: { size: 12 },
              usePointStyle: true
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            grid: {
              color: 'rgba(0, 0, 0, 0.05)'
            }
          },
          x: {
            grid: { display: false }
          }
        }
      }
    });

    // Export Report with animation
    document.getElementById('exportBtn').addEventListener('click', () => {
      const date = new Date().toISOString().split('T')[0];
      const report = `
╔═══════════════════════════════════════════════════════════╗
║           ResumeTrack Analytics Report                    ║
║           Generated: ${date}                        ║
╚═══════════════════════════════════════════════════════════╝

📊 KEY PERFORMANCE INDICATORS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⏱️  Avg Time-to-Hire:     28 Days (↓3 days)
📈 Conversion Rate:       21% (↑5%)
👥 Active Candidates:     173

📋 PIPELINE DISTRIBUTION
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Applied:      65 candidates
Screening:    48 candidates
Interview:    42 candidates
Offer:        18 candidates
Hired:        52 candidates
Rejected:     23 candidates

💼 TOP SKILLS IN DEMAND
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1. JavaScript    85 positions
2. Python        72 positions
3. React         68 positions
4. Java          65 positions
5. Node.js       58 positions
6. AWS           52 positions
7. SQL           48 positions
8. Docker        45 positions

📈 HIRING TRENDS (Last 6 Months)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Month       Hired   Applications   Interviews
May         8       45            22
June        12      52            28
July        15      48            25
August      10      55            30
September   14      62            35
October     12      58            32

💡 KEY INSIGHTS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎯 Conversion rate improved by 5% this month
⚡ Time-to-hire decreased by 3 days on average
🔥 JavaScript and Python lead skill requirements

Generated by ResumeTrack Analytics Engine
      `;

      const blob = new Blob([report], { type: 'text/plain' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = `ResumeTrack_Report_${date}.txt`;
      a.click();

      // Show success message
      const successMsg = document.getElementById('exportSuccess');
      successMsg.classList.remove('hidden');
      successMsg.style.animation = 'slideIn 0.3s ease-out';

      // Hide after 4 seconds
      setTimeout(() => {
        successMsg.style.animation = 'slideOut 0.3s ease-out';
        setTimeout(() => {
          successMsg.classList.add('hidden');
        }, 300);
      }, 4000);

      // Scroll to top
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // Add animation styles
    const style = document.createElement('style');
    style.textContent = `
      @keyframes slideIn {
        from {
          transform: translateY(-20px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }
      @keyframes slideOut {
        from {
          transform: translateY(0);
          opacity: 1;
        }
        to {
          transform: translateY(-20px);
          opacity: 0;
        }
      }
    `;
    document.head.appendChild(style);
  </script>
</body>
</html>